{"componentChunkName":"component---src-templates-blog-post-tsx","path":"/s3-presigned-url","result":{"data":{"mdx":{"body":"function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsxRuntime classic */\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"tag\": [\"aws-s3\", \"s3\", \"aws\", \"presignedUrl\"],\n  \"title\": \"Presigned Url을 활용한 S3 업로드/다운로드\",\n  \"slug\": \"s3-presigned-url\",\n  \"date\": \"2021-01-28T15:00:00.000Z\",\n  \"excerpt\": \"Presigned url을 이용해서 S3에 파일을 업로드/다운로드 해보자\",\n  \"image\": \"\"\n};\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, [\"components\"]);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"p\", null, \"\\uCD5C\\uADFC \\uD68C\\uC0AC \\uD648\\uD398\\uC774\\uC9C0\\uC5D0 \\uBE44\\uB85C\\uADF8\\uC778\\uD55C \\uBD88\\uD2B9\\uC815 \\uB2E4\\uC218\\uB85C \\uBD80\\uD130 \\uBB34\\uC5B8\\uAC00\\uB97C \\uC81C\\uCD9C \\uBC1B\\uC544 \\uD2B9\\uC815 \\uC774\\uBA54\\uC77C\\uB85C \\uD3EC\\uC6CC\\uB529 \\uD574\\uC8FC\\uB294 \\uAE30\\uB2A5\\uC744 \\uAD6C\\uD604\\uD574\\uC57C \\uD560 \\uC77C\\uC774 \\uC0DD\\uACBC\\uC5C8\\uB2E4. \\uCC98\\uC74C \\uC0DD\\uAC01\\uC740 \\uD504\\uB860\\uD2B8\\uC5D0\\uC11C \\uD30C\\uC77C\\uC744 \\uC5C5\\uB85C\\uB4DC\\uD558\\uBA74 \\uBC31\\uC5D4\\uB4DC\\uC5D0\\uC11C \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"Nodemailer\"), \"\\uB97C \\uC774\\uC6A9\\uD574\\uC11C \\uD3EC\\uC6CC\\uB529 \\uD574\\uC8FC\\uB294 \\uBC29\\uC2DD\\uC774\\uC5C8\\uB2E4.\"), mdx(\"p\", null, \"\\uADF8\\uB7F0\\uB370 serverless-offline\\uC758 \\uBB38\\uC81C\\uC778\\uC9C0 \\uBC31\\uC5D4\\uB4DC\\uB85C \\uB118\\uC5B4\\uC628 binary\\uD30C\\uC77C\\uC774 \\uACC4\\uC18D \\uC774\\uC0C1\\uD558\\uAC8C \\uC624\\uC5FC\\uB418\\uB294 \\uBB38\\uC81C\\uAC00 \\uC788\\uC5C8\\uB2E4.\"), mdx(\"p\", null, mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/dherault/serverless-offline/issues/464\"\n  }), \"\\uAD00\\uB828 \\uC774\\uC288\")), mdx(\"p\", null, \"\\uACB0\\uAD6D \\uD504\\uB860\\uD2B8\\uC5D0\\uC11C \\uC9C1\\uC811 s3\\uC5D0 \\uD30C\\uC77C\\uC744 \\uC5C5\\uB85C\\uB4DC \\uD558\\uACE0 s3\\uC5D0 object\\uAC00 \\uCD94\\uAC00\\uB85C \\uC0DD\\uC131\\uB420 \\uB54C\\uB9C8\\uB2E4 \\uB78C\\uB2E4\\uB97C \\uD1B5\\uD574 \\uC9C0\\uC815\\uB41C \\uC0AC\\uC6A9\\uC790\\uC5D0\\uAC8C \\uBA54\\uC77C\\uB85C \\uD3EC\\uC6CC\\uB529 \\uD558\\uB294 \\uBC29\\uC2DD\\uC744 \\uD0DD\\uD558\\uAC8C \\uB418\\uC5C8\\uB2E4.\"), mdx(\"p\", null, \"\\uBC84\\uD0B7\\uC744 \\uD37C\\uBE14\\uB9AD\\uD558\\uAC8C \\uC5F4\\uC5B4\\uBC84\\uB9AC\\uBA74 \\uBCC4\\uB2E4\\uB978 \\uC791\\uC5C5\\uC774 \\uD544\\uC694 \\uC5C6\\uC9C0\\uB9CC \\uB2F9\\uC5F0\\uD788 \\uC774\\uB807\\uAC8C \\uBB38\\uC744 \\uD655\\uC9DD \\uC5F4\\uC5B4\\uB458 \\uC218\\uB294 \\uC5C6\\uB294 \\uB178\\uB987\\uC774\\uB2C8 \\uC5C5\\uB85C\\uB4DC, \\uB2E4\\uC6B4\\uB85C\\uB4DC\\uC5D0 presigned-url\\uC744 \\uC774\\uC6A9\\uD558\\uAE30\\uB85C \\uD588\\uB2E4.\"), mdx(\"p\", null, \"presigned url\\uC744 \\uC774\\uC6A9\\uD55C \\uC808\\uCC28\\uB97C \\uAC04\\uB2E8\\uD788 \\uC368\\uBCF4\\uBA74 \\uC544\\uB798\\uC640 \\uAC19\\uB2E4.\"), mdx(\"ol\", null, mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"\\uD074\\uB77C\\uC774\\uC5B8\\uD2B8\\uC5D0\\uC11C \\uC5C5\\uB85C\\uB4DC\\uD560 \\uD30C\\uC77C\\uC758 \\uC815\\uBCF4\\uB97C \\uB2F4\\uC544 \\uBC31\\uC5D4\\uB4DC\\uC5D0 s3 PutObject\\uB97C \\uC704\\uD55C signed url\\uC744 \\uC694\\uCCAD\\uD55C\\uB2E4.\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"\\uBC1B\\uC544\\uC628 url\\uB85C \\uD30C\\uC77C\\uC73C\\uB974 \\uB2F4\\uC544 post\\uC694\\uCCAD\\uC744 \\uBCF4\\uB0B8\\uB2E4.\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"S3 Object\\uAC00 \\uC0DD\\uC131\\uB420 \\uB54C\\uB9C8\\uB2E4 \\uC2E4\\uD589\\uB420 \\uB78C\\uB2E4\\uB97C \\uD1B5\\uD574 \\uBA54\\uC77C\\uC744 \\uD3EC\\uC6CC\\uB4DC\\uD55C\\uB2E4.\")), mdx(\"h3\", null, \"Signed Url \\uC0DD\\uC131\"), mdx(\"p\", null, \"\\uC6B0\\uC120 lambda\\uB97C \\uC774\\uC6A9\\uD558\\uC5EC signed url\\uC744 \\uC0DD\\uC131\\uD558\\uB294 \\uCF54\\uB4DC\\uB97C \\uC791\\uC131\\uD574\\uBCF4\\uC790.\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-typescript\"\n  }), \"import AWS from 'aws-sdk';\\n\\nexport async function getSignedUrl(res, req, next) {\\n  const s3 = new AWS.S3({ region: 'my-region' });\\n  \\n  const { author, title, contentType } = req.body;\\n  const key = `${author}-${title}`;\\n  \\n  try {\\n    const signedUrl = s3.getSignedUrl(\\\"PutObject\\\", {\\n      Bucket: \\\"BucketName\\\", // Bucket name\\n      Key: `${key}.pdf`, // S3\\uC5D0 \\uC800\\uC7A5\\uB420 object\\uC758 key\\n      ContentType: contentType, // content type\\n      Metadata: {\\n        author,\\n        title,\\n      } // s3\\uC5D0 \\uC800\\uC7A5\\uB420 \\uB54C \\uC2E4\\uD589\\uB420 lambda\\uC5D0\\uC11C \\uC0AC\\uC6A9\\uD558\\uAE30 \\uC704\\uD55C metadata\\n    });\\n    \\n    res.status(200).json(signedUrl);\\n  } catch(e) {\\n    next(e);\\n  }\\n}\\n\")), mdx(\"p\", null, \"signed url\\uC744 \\uC694\\uCCAD\\uD560 \\uB54C post body\\uC5D0 \\uD544\\uC694\\uD55C \\uB370\\uC774\\uD130\\uB4E4\\uC744 \\uB2F4\\uC544\\uC11C \\uBCF4\\uB0B4\\uBA74 \\uB78C\\uB2E4\\uC5D0\\uC11C \\uD574\\uB2F9 \\uB370\\uC774\\uD130\\uB4E4\\uC744 \\uC870\\uD569\\uD558\\uC5EC \\uC6D0\\uD558\\uB294 \\uD615\\uD0DC\\uB85C s3 object\\uC758 key\\uB97C \\uC0DD\\uC131\\uD55C\\uB2E4. \\uC0DD\\uC131\\uB41C url\\uC744 \\uB2E4\\uC2DC \\uD074\\uB77C\\uC774\\uC5B8\\uD2B8\\uB85C \\uBCF4\\uB0B4\\uC900\\uB2E4.\"), mdx(\"p\", null, \"signed url\\uC744 \\uC0DD\\uC131\\uD560 \\uB54C \\uC635\\uC158\\uC758 \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"Expires\"), \" property\\uB97C \\uD1B5\\uD574 url\\uC758 \\uC720\\uD6A8\\uAE30\\uAC04\\uC744 \\uC124\\uC815\\uD560 \\uC218 \\uC788\\uB2E4.\"), mdx(\"p\", null, mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"Metadata\"), \"\\uB294 \\uD574\\uB2F9 object\\uC758 \\uBA54\\uD0C0\\uB370\\uC774\\uD130\\uB97C \\uC800\\uC7A5\\uD558\\uAE30 \\uC704\\uD55C \\uAC12\\uB4E4\\uC778\\uB370 \\uBA54\\uC77C\\uB85C \\uD3EC\\uC6CC\\uB529 \\uD560 \\uB54C \\uC2E4\\uC81C \\uBA54\\uC77C \\uBCF8\\uBB38\\uC5D0 \\uD3EC\\uD568\\uB418\\uC5B4\\uC57C \\uD560 \\uB370\\uC774\\uD130\\uB4E4\\uC744 \\uBA54\\uD0C0\\uB370\\uC774\\uD130 \\uD615\\uD0DC\\uB85C \\uBC1B\\uAE30 \\uC704\\uD574 \\uC124\\uC815\\uD574 \\uB450\\uC5C8\\uB2E4. \\uD574\\uB2F9 \\uBA54\\uD0C0\\uB370\\uC774\\uD130 \\uAC01 key\\uC5D0 \\uB300\\uD55C \\uC2E4\\uC81C \\uAC12\\uB4E4\\uC740 s3\\uC5D0 \\uD30C\\uC77C\\uC744 \\uC5C5\\uB85C\\uB4DC \\uD560 \\uB54C \\uD568\\uAED8 request header\\uC5D0 \\uB2F4\\uC544 \\uBCF4\\uB0B4\\uC57C \\uD55C\\uB2E4.\"), mdx(\"h3\", null, \"\\uD074\\uB77C\\uC774\\uC5B8\\uD2B8\\uC5D0\\uC11C \\uD30C\\uC77C \\uC5C5\\uB85C\\uB4DC\\uD558\\uAE30\"), mdx(\"p\", null, \"\\uC5EC\\uAE30\\uC11C\\uB294 PutObject\\uB85C url\\uC744 \\uC124\\uC815\\uD588\\uAE30 \\uB54C\\uBB38\\uC5D0 \\uBC18\\uB4DC\\uC2DC put method\\uB85C \\uC694\\uCCAD\\uC744 \\uBCF4\\uB0B4\\uC57C \\uD55C\\uB2E4.\\n\\uBA54\\uD0C0\\uB370\\uC774\\uD130\\uB294 request header\\uC5D0 \\uC544\\uB798\\uC640 \\uAC19\\uC774 \\uB2F4\\uC544\\uC11C \\uBCF4\\uB0B4\\uBA74 \\uB41C\\uB2E4.\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-typescript\"\n  }), \"axios.put(signedUrl, file, {\\n  headers: {\\n    \\\"x-amz-meta-author\\\": \\\"Paul Auster\\\",\\n    \\\"x-amz-meta-title\\\": \\\"Moon Palace\\\"\\n  }\\n});\\n\")), mdx(\"p\", null, mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"x-amz-meta\"), \"\\uB77C\\uB294 prefix\\uB97C \\uBD99\\uC5EC\\uC11C \\uAC01\\uAC01\\uC758 \\uBA54\\uD0C0 \\uB370\\uC774\\uD130\\uC5D0 \\uD574\\uB2F9\\uD558\\uB294 \\uAC12\\uB4E4\\uC744 \\uB2F4\\uC544 \\uBCF4\\uB0B4\\uBA74 \\uB41C\\uB2E4. url\\uC744 \\uC0DD\\uC131\\uD560 \\uB54C \\uC9C0\\uC815\\uD55C \\uBA54\\uD0C0\\uB370\\uC774\\uD130\\uC640 \\uC77C\\uCE58\\uD574\\uC57C \\uD55C\\uB2E4.\"), mdx(\"h3\", null, \"\\uBA54\\uC77C \\uD3EC\\uC6CC\\uB529\"), mdx(\"p\", null, \"\\uC774\\uC81C s3 PutObject \\uC774\\uBCA4\\uD2B8\\uC5D0 \\uB78C\\uB2E4\\uB97C \\uBD99\\uC5EC\\uC11C \\uBA54\\uC77C\\uC744 \\uD3EC\\uC6CC\\uB4DC \\uD574\\uBCF4\\uC790\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-typescript\"\n  }), \"import AWS from 'aws-sdk';\\n\\nexport async function forwardMail(event) {\\n  const s3 = new AWS.S3({\\n    region: 'YOUR-REGION',\\n  });\\n  \\n  const Bucket = event.Records[0].s3.bucket.name;\\n  const rawKey = event.Records[0].s3.object.key;\\n  const Key = decodeURIComponent(rawKey.replace(/\\\\+/g, \\\" \\\"));\\n  const object = await s3.getObject({ Bucket, Key }).promise();    \\n  \\n  const { author, title } = object.Metadata;\\n}\\n\")), mdx(\"p\", null, \"\\uC774\\uB807\\uAC8C \\uD558\\uBA74 object\\uC640 metadata\\uB97C \\uAC00\\uC838\\uC62C \\uC218 \\uC788\\uB294\\uB370 \\uC774\\uC81C \\uBA54\\uC77C\\uC744 \\uD3EC\\uC6CC\\uB4DC \\uD560 \\uB54C \\uBA54\\uD0C0\\uB370\\uC774\\uD130\\uB97C \\uC774\\uC6A9\\uD574 \\uBA54\\uC77C \\uC81C\\uBAA9, \\uBCF8\\uBB38\\uC758 \\uB0B4\\uC6A9\\uC744 \\uC791\\uC131\\uD558\\uACE0 \\uD30C\\uC77C\\uC744 \\uCCA8\\uBD80\\uD558\\uC5EC \\uBCF4\\uB0B4\\uBA74 \\uB41C\\uB2E4.\"), mdx(\"p\", null, \"\\uADF8\\uB7F0\\uB370 \\uC5EC\\uAE30\\uC11C \\uADC0\\uCC2E\\uC544\\uC11C \\uADF8\\uB0E5 \\uC2E4\\uC81C object\\uC758 url\\uC744 \\uBA54\\uC77C\\uC5D0 \\uC0BD\\uC785\\uD574\\uC11C \\uBCF4\\uB0C8\\uB294\\uB370 \\uC774\\uAC83\\uB3C4 \\uC870\\uAE08 \\uB354 \\uC548\\uC804\\uD558\\uAC8C \\uD558\\uC790\\uBA74 getObject\\uC5D0 \\uB300\\uD55C signedUrl\\uC744 \\uC0DD\\uC131\\uD574\\uC11C \\uBA54\\uC77C\\uC5D0 \\uB2F4\\uC544 \\uBCF4\\uB0B4\\uBA74 url\\uC774 valid\\uD55C \\uAE30\\uAC04 \\uB3D9\\uC548\\uB9CC \\uB2E4\\uC6B4\\uB85C\\uB4DC \\uAC00\\uB2A5\\uD558\\uAC8C \\uD560 \\uC218 \\uC788\\uB2E4.\"), mdx(\"p\", null, \"\\uD558\\uB098 \\uC0BD\\uC9C8\\uC744 \\uD588\\uB358 \\uD3EC\\uC778\\uD2B8\\uB294 object\\uC758 \\uD0A4 \\uAC12\\uC774 \\uB2E4\\uC18C \\uC774\\uC0C1\\uD55C \\uBC29\\uC2DD\\uC73C\\uB85C \\uC778\\uCF54\\uB529\\uB41C\\uB2E4\\uB294 \\uC810\\uC778\\uB370 \\uC6B0\\uC120 \\uACF5\\uBC31\\uC774 \\uC8C4\\uB2E4 \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"+\"), \"\\uB85C \\uBC14\\uB00C\\uC5B4 \\uC800\\uC7A5\\uC774 \\uB41C\\uB2E4. \\uB098\\uBA38\\uC9C0\\uB294 \\uC77C\\uBC18\\uC801\\uC778 url encoding\\uBC29\\uC2DD\\uC778\\uB370 \\uB530\\uB77C\\uC11C decode\\uD558\\uAE30 \\uC804\\uC5D0 \\uBA3C\\uC800 \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"+\"), \"\\uB97C \\uB2E4\\uC2DC \\uACF5\\uBC31\\uC73C\\uB85C \\uBC14\\uAFD4\\uC918\\uC57C \\uD55C\\uB2E4.\"));\n}\n;\nMDXContent.isMDXComponent = true;","frontmatter":{"date":"2021-01-28T15:00:00.000Z","excerpt":"Presigned url을 이용해서 S3에 파일을 업로드/다운로드 해보자","slug":"s3-presigned-url","title":"Presigned Url을 활용한 S3 업로드/다운로드"}}},"pageContext":{"id":"1aa7e35f-1817-5f1b-8f57-48069a1511b6"}},"staticQueryHashes":["3159585216","63159454"]}