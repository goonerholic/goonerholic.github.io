<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta name="generator" content="Gatsby 2.26.1"/><title data-react-helmet="true">Github actions를 활용한 Gatsby 앱 배포 자동화 | 보통인부</title><meta data-react-helmet="true" name="description" content="Github actions를 이용해 github-page에 Gatsby블로그를 배포해보자"/><meta data-react-helmet="true" property="og:title" content="Github actions를 활용한 Gatsby 앱 배포 자동화"/><meta data-react-helmet="true" property="og:description" content="Github actions를 이용해 github-page에 Gatsby블로그를 배포해보자"/><meta data-react-helmet="true" property="og:type" content="website"/><meta data-react-helmet="true" name="twitter:card" content="summary"/><meta data-react-helmet="true" name="twitter:creator" content="보통인부"/><meta data-react-helmet="true" name="twitter:title" content="Github actions를 활용한 Gatsby 앱 배포 자동화"/><meta data-react-helmet="true" name="twitter:description" content="Github actions를 이용해 github-page에 Gatsby블로그를 배포해보자"/><meta data-react-helmet="true" name="google-site-verification" content="TRn_eMmGmWot8k3g3MLAL616QB5zVLDihg8TVJof8-g"/><link href="https://fonts.googleapis.com/css2?family=Roboto&amp;family=Noto+Sans+KR&amp;family=Inconsolata&amp;display=swap" rel="stylesheet"/><link href="https://fonts.googleapis.com/css2?family=Roboto&amp;family=Noto+Sans+KR&amp;display=swap" rel="stylesheet"/><link rel="icon" href="/favicon-32x32.png?v=fbc45f90b1dc6985b32cb07171f63848" type="image/png"/><link rel="manifest" href="/manifest.webmanifest" crossorigin="anonymous"/><meta name="theme-color" content="#212529"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=fbc45f90b1dc6985b32cb07171f63848"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=fbc45f90b1dc6985b32cb07171f63848"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=fbc45f90b1dc6985b32cb07171f63848"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=fbc45f90b1dc6985b32cb07171f63848"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=fbc45f90b1dc6985b32cb07171f63848"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=fbc45f90b1dc6985b32cb07171f63848"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=fbc45f90b1dc6985b32cb07171f63848"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=fbc45f90b1dc6985b32cb07171f63848"/><link rel="preconnect dns-prefetch" href="https://www.google-analytics.com"/><link rel="sitemap" type="application/xml" href="/sitemap.xml"/><link as="script" rel="preload" href="/webpack-runtime-c9bd2ca99c488b7a36ef.js"/><link as="script" rel="preload" href="/framework-741ade27086b2708e961.js"/><link as="script" rel="preload" href="/dc6a8720040df98778fe970bf6c000a41750d3ae-6d990d7ef725645fa46e.js"/><link as="script" rel="preload" href="/app-8a1a9e5c34505b06fc1b.js"/><link as="script" rel="preload" href="/commons-94bf3fed2c2a19c4b8cc.js"/><link as="script" rel="preload" href="/component---src-templates-blog-post-tsx-9fd55ffe3f757be93872.js"/><link as="fetch" rel="preload" href="/page-data/deploy-gatsby/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/3159585216.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/63159454.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div><style data-emotion="css-global 19b2nq0">html{font-size:10px;}*{box-sizing:border-box;margin:0;padding:0;word-break:keep-all;}.body{padding-top:5.9rem;min-height:calc(100vh - 10rem);font-family:-apple-system,Roboto,'Noto Sans KR';}h1,h2,h3,h4,h5{margin-top:3rem;}h1{font-size:4.8rem;font-weight:bold;margin-bottom:2rem;}h2{font-size:2.8rem;font-weight:bold;margin-bottom:1.6rem;}h3{font-size:2.4rem;font-weight:bold;margin-bottom:1.6rem;}h4{font-size:2.2rem;margin-bottom:1.6rem;}h5{font-size:2rem;margin-bottom:1.6rem;}p{font-size:1.6rem;font-weight:200;margin:1rem 0;}a{font-size:inherit;-webkit-text-decoration:none;text-decoration:none;color:inherit;}ul{list-style:none;font-size:1.6rem;}ol{font-size:1.6rem;}li{padding:0.5rem 0;}.icon{width:1.6rem;height:1.6rem;}hr{border:1px solid #ced4da;margin:1rem 0;}@media only screen and (max-width: 425px){h1{font-size:3rem;}}</style><style data-emotion="css hij3xh">.css-hij3xh{width:100%;padding:1.5rem 1rem;position:fixed;top:0;left:0;z-index:1000;background-color:#212529;-webkit-transition:background-color 0.4s;transition:background-color 0.4s;color:#ffffff;}.css-hij3xh .container{max-width:993px;width:100%;margin:0 auto;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding:0 1rem;}.css-hij3xh.scrolled{box-shadow:0 8px 8px 0 rgba(0, 0, 0, 0.2);}.css-hij3xh .header-logo{color:inherit;font-size:2.4rem;}.css-hij3xh .header-nav ul{list-style:none;font-size:1.6rem;}@media only screen and (max-width: 767px){.css-hij3xh .header-nav-toggle-btn{display:inline-block;border:none;background-color:transparent;color:#ffffff;outline:none;cursor:pointer;font-size:1.6rem;}.css-hij3xh .header-nav-list{display:none;}.css-hij3xh .header-nav-list.active{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;background-color:#495057;position:absolute;right:1rem;top:6.4rem;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:space-around;-ms-flex-pack:space-around;-webkit-justify-content:space-around;justify-content:space-around;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border-radius:0.6rem;box-shadow:0 1px 5px rgba(0, 0, 0, 0.46);}.css-hij3xh .header-nav-list.active li{padding:2rem 2rem;margin:0 1rem;}.css-hij3xh .header-nav-list.active li:not(:last-child){border-bottom:1px solid #868e96;}}@media only screen and (min-width: 768px){.css-hij3xh .header-nav-toggle-btn{display:none;}.css-hij3xh .header-nav-list{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:space-around;-ms-flex-pack:space-around;-webkit-justify-content:space-around;justify-content:space-around;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;list-style:none;}.css-hij3xh .header-nav-list .header-nav-list-item{margin-left:2rem;}}</style><header class="css-hij3xh"><div class="container"><div class="header-logo"><a href="/">보통인부</a></div><nav class="header-nav"><button class="header-nav-toggle-btn"><span role="img" aria-label="menu" class="anticon anticon-menu"><svg viewBox="64 64 896 896" focusable="false" data-icon="menu" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M904 160H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8zm0 624H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8zm0-312H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8z"></path></svg></span></button><ul class="header-nav-list"><li class="header-nav-list-item"><a href="/">홈</a></li><li class="header-nav-list-item"><a href="/posts">포스트</a></li></ul></nav></div></header><div class="body"><style data-emotion="css tf2gn">.css-tf2gn{padding:4rem 1rem;max-width:800px;margin:0 auto;}</style><div class="css-tf2gn"><style data-emotion="css cy839i">@media only screen and (max-width: 425px){.css-cy839i p{font-size:1.6rem;}}.css-cy839i .date{font-size:1.4rem;}.css-cy839i .post-body{font-family:Helvetica,arial,sans-serif;font-size:14px;line-height:1.6;padding-top:10px;padding-bottom:10px;background-color:white;color:#333;}.css-cy839i .post-body>*:first-child{margin-top:0!important;}.css-cy839i .post-body>*:last-child{margin-bottom:0!important;}.css-cy839i .post-body a{color:#4183c4;-webkit-text-decoration:none;text-decoration:none;}.css-cy839i .post-body a.absent{color:#cc0000;}.css-cy839i .post-body a.anchor{display:block;padding-left:30px;margin-left:-30px;cursor:pointer;position:absolute;top:0;left:0;bottom:0;}.css-cy839i .post-body h1,.css-cy839i .post-body h2,.css-cy839i .post-body h3,.css-cy839i .post-body h4,.css-cy839i .post-body h5,.css-cy839i .post-body h6{margin:20px 0 10px;padding:0;font-weight:bold;-webkit-font-smoothing:antialiased;cursor:text;position:relative;}.css-cy839i .post-body h2:first-child,.css-cy839i .post-body h1:first-child,.css-cy839i .post-body h1:first-child+h2,.css-cy839i .post-body h3:first-child,.css-cy839i .post-body h4:first-child,.css-cy839i .post-body h5:first-child,.css-cy839i .post-body h6:first-child{margin-top:0;padding-top:0;}.css-cy839i .post-body h1:hover a.anchor,.css-cy839i .post-body h2:hover a.anchor,.css-cy839i .post-body h3:hover a.anchor,.css-cy839i .post-body h4:hover a.anchor,.css-cy839i .post-body h5:hover a.anchor,.css-cy839i .post-body h6:hover a.anchor{-webkit-text-decoration:none;text-decoration:none;}.css-cy839i .post-body h1 tt,.css-cy839i .post-body h1 code{font-size:inherit;}.css-cy839i .post-body h2 tt,.css-cy839i .post-body h2 code{font-size:inherit;}.css-cy839i .post-body h3 tt,.css-cy839i .post-body h3 code{font-size:inherit;}.css-cy839i .post-body h4 tt,.css-cy839i .post-body h4 code{font-size:inherit;}.css-cy839i .post-body h5 tt,.css-cy839i .post-body h5 code{font-size:inherit;}.css-cy839i .post-body h6 tt,.css-cy839i .post-body h6 code{font-size:inherit;}.css-cy839i .post-body h1{font-size:28px;color:black;}.css-cy839i .post-body h2{font-size:24px;border-bottom:1px solid #cccccc;color:black;}.css-cy839i .post-body h3{font-size:18px;}.css-cy839i .post-body h4{font-size:16px;}.css-cy839i .post-body h5{font-size:14px;}.css-cy839i .post-body h6{color:#777777;font-size:14px;}.css-cy839i .post-body p,.css-cy839i .post-body blockquote,.css-cy839i .post-body ul,.css-cy839i .post-body ol,.css-cy839i .post-body dl,.css-cy839i .post-body table,.css-cy839i .post-body pre{margin:15px 0;}.css-cy839i .post-body hr{border:0 none;color:#cccccc;height:4px;padding:0;}.css-cy839i .post-body>h2:first-child{margin-top:0;padding-top:0;}.css-cy839i .post-body>h1:first-child{margin-top:0;padding-top:0;}.css-cy839i .post-body>h1:first-child+h2{margin-top:0;padding-top:0;}.css-cy839i .post-body body>h3:first-child,.css-cy839i .post-body body>h4:first-child,.css-cy839i .post-body body>h5:first-child,.css-cy839i .post-body body>h6:first-child{margin-top:0;padding-top:0;}.css-cy839i .post-body a:first-child h1,.css-cy839i .post-body a:first-child h2,.css-cy839i .post-body a:first-child h3,.css-cy839i .post-body a:first-child h4,.css-cy839i .post-body a:first-child h5,.css-cy839i .post-body a:first-child h6{margin-top:0;padding-top:0;}.css-cy839i .post-body h1 p,.css-cy839i .post-body h2 p,.css-cy839i .post-body h3 p,.css-cy839i .post-body h4 p,.css-cy839i .post-body h5 p,.css-cy839i .post-body h6 p{margin-top:0;}.css-cy839i .post-body li p.first{display:inline-block;}.css-cy839i .post-body ul{list-style:disc;}.css-cy839i .post-body ul,.css-cy839i .post-body ol{padding-left:30px;}.css-cy839i .post-body ul :first-child,.css-cy839i .post-body ol :first-child{margin-top:0;}.css-cy839i .post-body ul :last-child,.css-cy839i .post-body ol :last-child{margin-bottom:0;}.css-cy839i .post-body dl{padding:0;}.css-cy839i .post-body dl dt{font-size:14px;font-weight:bold;font-style:italic;padding:0;margin:15px 0 5px;}.css-cy839i .post-body dl dt:first-child{padding:0;}.css-cy839i .post-body dl dt>:first-child{margin-top:0;}.css-cy839i .post-body dl dt>:last-child{margin-bottom:0;}.css-cy839i .post-body dl dd{margin:0 0 15px;padding:0 15px;}.css-cy839i .post-body dl dd>:first-child{margin-top:0;}.css-cy839i .post-body dl dd>:last-child{margin-bottom:0;}.css-cy839i .post-body blockquote{border-left:4px solid #dddddd;padding:0 15px;color:#777777;}.css-cy839i .post-body blockquote>:first-child{margin-top:0;}.css-cy839i .post-body blockquote>:last-child{margin-bottom:0;}.css-cy839i .post-body table{padding:0;}.css-cy839i .post-body table tr{border-top:1px solid #cccccc;background-color:white;margin:0;padding:0;}.css-cy839i .post-body table tr:nth-child(2n){background-color:#f8f8f8;}.css-cy839i .post-body table tr th{font-weight:bold;border:1px solid #cccccc;text-align:left;margin:0;padding:6px 13px;}.css-cy839i .post-body table tr td{border:1px solid #cccccc;text-align:left;margin:0;padding:6px 13px;}.css-cy839i .post-body table tr th :first-child,.css-cy839i .post-body table tr td :first-child{margin-top:0;}.css-cy839i .post-body table tr th :last-child,.css-cy839i .post-body table tr td :last-child{margin-bottom:0;}.css-cy839i .post-body img{max-width:100%;}.css-cy839i .post-body span.frame{display:block;overflow:hidden;}.css-cy839i .post-body span.frame>span{border:1px solid #dddddd;display:block;float:left;overflow:hidden;margin:13px 0 0;padding:7px;width:auto;}.css-cy839i .post-body span.frame span img{display:block;float:left;}.css-cy839i .post-body span.frame span span{clear:both;color:#333333;display:block;padding:5px 0 0;}.css-cy839i .post-body span.align-center{display:block;overflow:hidden;clear:both;}.css-cy839i .post-body span.align-center>span{display:block;overflow:hidden;margin:13px auto 0;text-align:center;}.css-cy839i .post-body span.align-center span img{margin:0 auto;text-align:center;}.css-cy839i .post-body span.align-right{display:block;overflow:hidden;clear:both;}.css-cy839i .post-body span.align-right>span{display:block;overflow:hidden;margin:13px 0 0;text-align:right;}.css-cy839i .post-body span.align-right span img{margin:0;text-align:right;}.css-cy839i .post-body span.float-left{display:block;margin-right:13px;overflow:hidden;float:left;}.css-cy839i .post-body span.float-left span{margin:13px 0 0;}.css-cy839i .post-body span.float-right{display:block;margin-left:13px;overflow:hidden;float:right;}.css-cy839i .post-body span.float-right>span{display:block;overflow:hidden;margin:13px auto 0;text-align:right;}.css-cy839i .post-body code,.css-cy839i .post-body tt{margin:0 2px;padding:0 5px;white-space:pre-wrap;border:1px solid #eaeaea;background-color:#f8f8f8;border-radius:3px;}.css-cy839i .post-body pre{font-size:1.6rem;line-height:1.6;font-family:'Inconsolata';overflow-x:scroll;padding-bottom:2rem;}.css-cy839i .post-body pre::-webkit-scrollbar{height:4px;border-radius:1px;}.css-cy839i .post-body pre::-webkit-scrollbar-track{border-radius:1px;background-color:#343a40;}.css-cy839i .post-body pre::-webkit-scrollbar-thumb{border-radius:1px;background-color:#868e96;}.css-cy839i .post-body .gatsby-highlight{position:relative;border-radius:0.5rem;padding:1rem 1rem;-webkit-overflow-scrolling:touch;margin:2rem 0;}.css-cy839i .post-body .gatsby-highlight pre[class*='language-']{-webkit-overflow-scrolling:touch;}.css-cy839i .post-body .gatsby-highlight pre[class*='language-']:before{background:black;border-radius:0 0 0.25rem 0.25rem;color:white;font-size:1.8rem;letter-spacing:0.025rem;padding:0.1rem 0.5rem;position:absolute;right:1rem;text-align:right;text-transform:uppercase;top:0;}.css-cy839i .post-body .gatsby-highlight pre[class*='language-javascript']:before{content:'js';background:#f7df1e;color:black;}.css-cy839i .post-body .gatsby-highlight pre[class*='language-js']:before{content:'js';background:#f7df1e;color:black;}.css-cy839i .post-body .gatsby-highlight pre[class*='language-ts']:before{content:'ts';background:#3178c6;color:white;}.css-cy839i .post-body .gatsby-highlight pre[class*='language-html']:before{content:'html';background:#005a9c;color:white;}.css-cy839i .post-body .gatsby-highlight pre[class*='language-css']:before{content:'css';background:#ff9800;color:white;}</style><section class="css-cy839i"><h1>Github actions를 활용한 Gatsby 앱 배포 자동화</h1><span class="date">2/1/2021</span><hr/><article class="post-body"><h3>나는 github pages를 이용하고 싶다!</h3><p>구글에 검색해서 나오는 대부분의 gatsby 튜토리얼 들은 netlify에 배포하는 케이스를 다루고 있었다. 아무래도 배포가 간단하고 netlify에서 제공하는 cms를 붙이기도 쉽다보니 많이들 활용하는것 같았다. 근데 나는 github.io 페이지가 갖고 싶어서 무작정 github page부터 찾아보기 시작했다.</p><h3>일단 그냥 배포해보자</h3><p>사실 그냥 배포하는 건 쉽다.</p><p>우선 <a href="https://www.npmjs.com/package/gh-pages"><code>gh-pages</code></a> 패키지를 설치하고 아래와 같이 명령어를 입력하면 된다.</p><style data-emotion="css xbe36b">.css-xbe36b{color:#9CDCFE;background-color:#1E1E1E;}</style><div class="gatsby-highlight css-xbe36b" data-language="shell"><pre class="prism-code language-shell" style="color:#9CDCFE;background-color:#1E1E1E"><div class="token-line" style="color:#9CDCFE"><span class="token plain">gatsby build </span><span class="token operator" style="color:rgb(212, 212, 212)">&amp;&amp;</span><span class="token plain"> gh-pages -d public -r </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token plain">리파지토리 주소</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"> -b </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token plain">브랜치명</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span></div></pre></div><p>물론 그 전에 github에 pages 사용 설정을 해야하는데 그건 귀찮으니
잘 정리된 블로그로 대체!
<a href="https://wepplication.github.io/programming/github-pages/#:~:text=Github%20Pages%20%EC%82%AC%EC%9A%A9%ED%95%98%EA%B8%B0,%EC%84%A4%EC%A0%95%EC%9D%84%20%ED%95%98%EC%8B%A4%20%EC%88%98%20%EC%9E%88%EC%8A%B5%EB%8B%88%EB%8B%A4.&amp;text=%EA%B9%83%20%ED%8E%98%EC%9D%B4%EC%A7%80%20%EC%86%8C%EC%8A%A4%20%EC%84%A4%EC%A0%95%EC%9D%84,%EC%A0%95%EC%A0%81%20%EC%82%AC%EC%9D%B4%ED%8A%B8%EB%A5%BC%20%EC%83%9D%EC%84%B1%ED%95%A9%EB%8B%88%EB%8B%A4.">GitHub Pages를 이용한 무료 홈페이지 만들기</a></p><p>여기까지만 하면 사실 잘 배포되고 모두가 해피하지만 문제는 정적홈페이지라는 특성상 컨텐츠가 업데이트될 때마다 빌드해서 배포해줘야하는 귀찮음이 있다.</p><h3>Github actions 활용하기</h3><p>우선 나는 리파지토리의 master브랜치에 소스코드를 담고 gh-pages브랜치에 실제 빌드되어 배포될 정적파일들을 저장하는 구조를 택했다.</p><p>그렇다면 master브랜치에 push될 때 gh-pages 브랜치로 빌드를 해주면 된다.
다행스럽게 누군가 이미 만들어놓은 템플릿이 있어서 잘 가져다 쓰기만 하면 됨.</p><p><a href="https://github.com/enriikke/gatsby-gh-pages-action">gatsby-gh-pages-action</a></p><p>이걸 가지고 workflows yml파일을 만들어 보자</p><div class="gatsby-highlight css-xbe36b" data-language="yml"><pre class="prism-code language-yml" style="color:#9CDCFE;background-color:#1E1E1E"><div class="token-line" style="color:#9CDCFE"><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> Gatsby Publish</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token key atrule">on</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">pull_request</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">branches</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain"> master</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">paths-ignore</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;**/README.md&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">push</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">branches</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain"> master</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">paths-ignore</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;**/README.md&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token key atrule">jobs</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">deploy</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">runs-on</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> ubuntu</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">latest</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">steps</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain"> </span><span class="token key atrule">uses</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> actions/checkout@v1</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain"> </span><span class="token key atrule">uses</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> enriikke/gatsby</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">gh</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">pages</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">action@v2</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token key atrule">with</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">          </span><span class="token key atrule">access-token</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> $</span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> secrets.ACCESS_TOKEN </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">          </span><span class="token key atrule">deploy-branch</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> gh</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">pages</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">          </span><span class="token key atrule">skip-publish</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token boolean important">false</span></div></pre></div><p><code>master</code> 브랜치에 푸시되거나 풀리퀘스트가 보내졌을 때 action이 돌도록 설정했고 readme파일의 업데이트시에는 스킵하도록 paths-ignore를 설정해줬다.</p><p>하나 중요한 점은 <code>repo</code> scope를 갖는 personal access token이 필요한데 github 계정의 settings - Developer settings - Personal access token에서 생성가능하다.</p><p>이렇게 생성한 토큰을 해당 리파지토리의 secret에 저장해두고 secret name을 yml파일의 access-token 항목에 넣어주면 끝.</p><p>이제 마스터 브랜치에 푸쉬 할 때마다 자동으로 deploy되는 것을 확인할 수 있다.</p><h3>포스트 작성해서 푸쉬하는것도 귀찮아</h3><p>이제 cms를 붙일 차례다.
netlify를 먼저 고려했었는데 뭔가 netlify에 deploy되지 않은 앱에 붙이는건 귀찮아보여서 다른 cms서비스를 찾던 중 <a href="https://forestry.io/">Forestry</a>라는걸 발견했다.</p><p>간단하게 리파지토리 연동해주고 블로그 포스트의 frontmatter들을 설정해주면 포스트 작성 시 알아서 해당 리파지토리에 md파일이 생성된다.</p><p>이제 master에 md파일이 푸쉬되었으니 배포는 github action이 처리해줄 것이다.</p></article><hr/><div class="comment"><div id="disqus_thread"></div></div></section></div></div><style data-emotion="css 102xg1i">.css-102xg1i{padding:1.6rem 0;font-size:2rem;text-align:center;font-weight:normal;}.css-102xg1i span+span{margin-left:1rem;}</style><div class="css-102xg1i"><span><a href="https://github.com/goonerholic"><span role="img" aria-label="github" class="anticon anticon-github"><svg viewBox="64 64 896 896" focusable="false" data-icon="github" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M511.6 76.3C264.3 76.2 64 276.4 64 523.5 64 718.9 189.3 885 363.8 946c23.5 5.9 19.9-10.8 19.9-22.2v-77.5c-135.7 15.9-141.2-73.9-150.3-88.9C215 726 171.5 718 184.5 703c30.9-15.9 62.4 4 98.9 57.9 26.4 39.1 77.9 32.5 104 26 5.7-23.5 17.9-44.5 34.7-60.8-140.6-25.2-199.2-111-199.2-213 0-49.5 16.3-95 48.3-131.7-20.4-60.5 1.9-112.3 4.9-120 58.1-5.2 118.5 41.6 123.2 45.3 33-8.9 70.7-13.6 112.9-13.6 42.4 0 80.2 4.9 113.5 13.9 11.3-8.6 67.3-48.8 121.3-43.9 2.9 7.7 24.7 58.3 5.5 118 32.4 36.8 48.9 82.7 48.9 132.3 0 102.2-59 188.1-200 212.9a127.5 127.5 0 0138.1 91v112.5c.8 9 0 17.9 15 17.9 177.1-59.7 304.6-227 304.6-424.1 0-247.2-200.4-447.3-447.5-447.3z"></path></svg></span></a></span><span><a href="mailto:goonerholic@gmail.com"><span role="img" aria-label="mail" class="anticon anticon-mail"><svg viewBox="64 64 896 896" focusable="false" data-icon="mail" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M928 160H96c-17.7 0-32 14.3-32 32v640c0 17.7 14.3 32 32 32h832c17.7 0 32-14.3 32-32V192c0-17.7-14.3-32-32-32zm-40 110.8V792H136V270.8l-27.6-21.5 39.3-50.5 42.8 33.3h643.1l42.8-33.3 39.3 50.5-27.7 21.5zM833.6 232L512 482 190.4 232l-42.8-33.3-39.3 50.5 27.6 21.5 341.6 265.6a55.99 55.99 0 0068.7 0L888 270.8l27.6-21.5-39.3-50.5-42.7 33.2z"></path></svg></span></a></span><span><a href="https://www.linkedin.com/in/taehwa-yoon-a88253102/"><span role="img" aria-label="linkedin" class="anticon anticon-linkedin"><svg viewBox="64 64 896 896" focusable="false" data-icon="linkedin" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M847.7 112H176.3c-35.5 0-64.3 28.8-64.3 64.3v671.4c0 35.5 28.8 64.3 64.3 64.3h671.4c35.5 0 64.3-28.8 64.3-64.3V176.3c0-35.5-28.8-64.3-64.3-64.3zm0 736c-447.8-.1-671.7-.2-671.7-.3.1-447.8.2-671.7.3-671.7 447.8.1 671.7.2 671.7.3-.1 447.8-.2 671.7-.3 671.7zM230.6 411.9h118.7v381.8H230.6zm59.4-52.2c37.9 0 68.8-30.8 68.8-68.8a68.8 68.8 0 10-137.6 0c-.1 38 30.7 68.8 68.8 68.8zm252.3 245.1c0-49.8 9.5-98 71.2-98 60.8 0 61.7 56.9 61.7 101.2v185.7h118.6V584.3c0-102.8-22.2-181.9-142.3-181.9-57.7 0-96.4 31.7-112.3 61.7h-1.6v-52.2H423.7v381.8h118.6V604.8z"></path></svg></span></a></span><p>Powered by Gatsby</p></div></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-176331867-1"></script><script>
      
      
      if(true) {
        window.dataLayer = window.dataLayer || [];
        function gtag(){window.dataLayer && window.dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'UA-176331867-1', {"send_page_view":false});
      }
      </script><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/deploy-gatsby";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-979d3b99eeadb13a5c80.js"],"app":["/app-8a1a9e5c34505b06fc1b.js"],"component---src-pages-404-tsx":["/component---src-pages-404-tsx-38852eab18727ba4a853.js"],"component---src-pages-index-tsx":["/component---src-pages-index-tsx-16d871f81ded96c45eab.js"],"component---src-templates-blog-post-tsx":["/component---src-templates-blog-post-tsx-9fd55ffe3f757be93872.js"],"component---src-templates-post-list-page-tsx":["/component---src-templates-post-list-page-tsx-437c62e57084ef3983f1.js"]};/*]]>*/</script><script src="/polyfill-979d3b99eeadb13a5c80.js" nomodule=""></script><script src="/component---src-templates-blog-post-tsx-9fd55ffe3f757be93872.js" async=""></script><script src="/commons-94bf3fed2c2a19c4b8cc.js" async=""></script><script src="/app-8a1a9e5c34505b06fc1b.js" async=""></script><script src="/dc6a8720040df98778fe970bf6c000a41750d3ae-6d990d7ef725645fa46e.js" async=""></script><script src="/framework-741ade27086b2708e961.js" async=""></script><script src="/webpack-runtime-c9bd2ca99c488b7a36ef.js" async=""></script></body></html>